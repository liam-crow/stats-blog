---
title: "Introduction to AFL Analytics with Useless AFL Stats"
author: Liam Crowhurst
date: '2022-08-10'
slug: introduction-afl-analytics-data-R
categories:
  - AFL Data Tutorial
tags:
  - R
  - Useless AFL Stats
  - Introduction to R
banner: ''
description: 'A beginners guide to AFL analytics and programming in R!'
images: []
menu: ''
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>I’m co-admin of a little page on Facebook that caters to a niche audience of AFL statistics nerds known as <a href="https://www.facebook.com/uselessaflstats" target="blank">Useless AFL Stats</a>, where (founder and co-admin) Aaron and I discover stats that have no relevance to anything at all, and will never be useful to anyone, ever. And that got me thinking, why should I have all the fun finding these nuggets of gold?</p>
<p>I’m a firm believer in open source programming and open data, the philosophy that as much data should be made publicly available as possible to the largest possible audience. A thousand or so brains are going to be more innovative, better at analysing trends, faster at fact checking (and creating useless AFL stats) than just 2.</p>
<p>That’s why I’ll be taking you on a journey from beginner to expert, to give you the tools to be the master of your own AFL data analysis. Key points will be covered in this first post:</p>
<ul>
<li>Setup of your coding workspace
<ul>
<li>R installation</li>
<li>Rstudio installation and setup</li>
</ul></li>
<li>Basics of R</li>
<li>Downloading AFL data</li>
<li>Creating your first useless AFL stat</li>
</ul>
<p>If you have any questions during this tutorial, you can tweet at me <a href="https://twitter.com/crow_data_sci" target="blank">@crow_data_sci</a>. If you’ve got a useless stat, feel free to tweet at us <a href="https://twitter.com/UselessStatsAFL" target="blank">@UselessStatsAFL</a> or message our facebook page.</p>
<p>Ok, let get into the setup!</p>
<div id="r-and-rstudio-installation" class="section level1">
<h1>R and RStudio Installation</h1>
<p>The program that we’ll be using to generate stats is <a href="https://www.r-project.org/" target="blank">R</a>, a powerful tool commonly used by professional statisticians and data scientists in academia and industry, but we’ll be using it to shitpost about AFL stats.</p>
<p>We’ll be downloading R from here <a href="https://cloud.r-project.org/" target="blank">https://cloud.r-project.org/</a> and choose the version for your OS. I’d recommend all the default file locations and setup. If you are using a MAC OS, click <code>R-4.2.x.pkg</code> which is the executable.</p>
<p>We’ll also be using RStudio, a Graphical User Interface (GUI) that allows for easier use of the R language. Download the free version here at <a href="https://rstudio.com/products/rstudio/download/" target="blank">https://rstudio.com/products/rstudio/download/</a>.</p>
<p>Once they’ve been downloaded, open up your newly installed RStudio program. It should automatically find R and open up an interface. Think of the R language as the frame, steering wheel and engine of a car. You can get pretty far with just that, but RStudio completes the car, adding all the bells and whistles for a more comfortable journey. God that’s a terrible analogy.</p>
<div id="basics-of-r" class="section level2">
<h2>Basics of R</h2>
<p>Anyway, you should see a screen and tab named ‘Console’. This is where all the the commands get executed, lets try a couple out.</p>
<pre class="r"><code>1+1</code></pre>
<pre><code>## [1] 2</code></pre>
<pre class="r"><code>2*4</code></pre>
<pre><code>## [1] 8</code></pre>
<pre class="r"><code>3^3</code></pre>
<pre><code>## [1] 27</code></pre>
<p>What you’ll see is that the answer has been calculated and result has been produced on the next line.</p>
<p>Let’s save these results, we may want to use them later. In R we use an assignment command <code>&lt;-</code>, which looks like a backwards arrow. You can assign a result to any string of characters. You can also assign characters (like names, teams, locations, etc) to variables too.</p>
<pre class="r"><code>a &lt;- 1+1
b &lt;- 2*4
c &lt;- 3^3
first_name &lt;- &#39;John&#39;</code></pre>
<p>If you look at the ‘Environment’ tab in the top right section, we can see our newly created variables. Variables can be used in commands with each other too. You can’t add strings to numbers though.</p>
<pre class="r"><code>a + b * c</code></pre>
<pre><code>## [1] 218</code></pre>
<p>Another important concept are vectors, a data structure that can hold multiple values. We use <code>c()</code> to denote a vector and we can insert multiple values.</p>
<pre class="r"><code>d &lt;- c(3,7,8,2)
teams &lt;- c(&#39;WCE&#39;,&#39;Freo&#39;,&#39;Geel&#39;)
d</code></pre>
<pre><code>## [1] 3 7 8 2</code></pre>
<pre class="r"><code>d*2</code></pre>
<pre><code>## [1]  6 14 16  4</code></pre>
<pre class="r"><code>d[3]</code></pre>
<pre><code>## [1] 8</code></pre>
<pre class="r"><code>teams[2]</code></pre>
<pre><code>## [1] &quot;Freo&quot;</code></pre>
<p>We can multiply and add to vectors and use square brackets to pull out certain indexes (positions) of the vector. Press the up arrow to cycle backwards through your previous commands.</p>
</div>
<div id="projects" class="section level2">
<h2>Projects</h2>
<p>Projects help contain all of your data and files in an easy to maintain structure. We’ll create one for all of our AFL data analysis.</p>
<ol style="list-style-type: decimal">
<li>Click the dropdown menu in the top right corner</li>
<li>New project (and save)</li>
<li>New Directory</li>
<li>New Project</li>
<li>Name it (<code>AFL_Scripts</code> or something similar)</li>
</ol>
<p>This initialises your new project, and we’ll do all our analysis in this project. Use the command <code>getwd()</code> in the console to find out the file path of this directory. You should see something similar to <code>C:/Users/your_name/Documents/AFL_Scripts</code>.</p>
</div>
<div id="scripts" class="section level2">
<h2>Scripts</h2>
<p>Scripts are an easy way to store commands that you want to come back to later, and all of our data analysis will be written in scripts. To create a new script:</p>
<ol style="list-style-type: decimal">
<li>File (top left)</li>
<li>New File</li>
<li>R Script</li>
</ol>
<p>Writing commands in the script and pressing enter will not execute the command, but will take you to a newline. To execute a line, use <code>Ctrl</code> + <code>Enter</code>. Press <code>Ctrl</code> + <code>S</code>to save your script, and you should see it appear in the ‘Files’ tab on the right of RStudio.</p>
</div>
</div>
<div id="lets-get-into-some-afl-analytics" class="section level1">
<h1>Let’s get into some AFL Analytics!</h1>
<p>In our new script, we first need to install some packages and load them into our workspace by executing the following commands in the console (not the Script).</p>
<div id="installing-packages" class="section level2">
<h2>Installing packages</h2>
<pre class="r"><code>install.packages(&quot;devtools&quot;) #allows us to download from github
install.packages(&quot;dplyr&quot;)    #data manipulation tools
install.packages(&quot;tidyr&quot;)    #more data manipulation tools
install.packages(&quot;snakecase&quot;)#data cleaning tool
install.packages(&quot;hms&quot;)      #date formatting
devtools::install_github(&quot;jimmyday12/fitzRoy&quot;) #package that loads afltables into R</code></pre>
<p>Ignore the warning about “Rtools”, it’s a windows development tool that we won’t be using.</p>
</div>
<div id="loading-packages" class="section level2">
<h2>Loading packages</h2>
<pre class="r"><code>library(dplyr)
library(tidyr)
library(snakecase)
library(fitzRoy)</code></pre>
<p>Here’s another analogy, think of <code>install.packages</code> as a light bulb and <code>library</code> as a switch. You only need to install a package once (unless you update R), and can use the <code>library</code> function to turn them on when needed.</p>
<p>Side note using a hash (<code>#</code>) is a programming technique called commenting. Anything after a <code>#</code> will not be run and it allows the programmer to add notes, like what a certain line or function does.</p>
</div>
</div>
<div id="loading-in-afl-data" class="section level1">
<h1>Loading in AFL data</h1>
<p>Now that we have everything set up, we can dive right in to the stats. We are going to load in data from <a href="https://afltables.com/afl/afl_index.html" target="blank">afltables.com</a> using <a href="https://github.com/jimmyday12/fitzRoy" target="blank">fitzRoy</a>, an R package put together by <a href="https://twitter.com/jamesday87" target="blank">James Day</a> that contains most of the match data in a consistent structure.</p>
<p>Lets load in all the data from the year 2000 onwards and assign it to a variable.</p>
<pre class="r"><code>afltables &lt;- fetch_player_stats_afltables(season = 2021) #loads in 2021 data</code></pre>
<pre><code>## i Looking for data from 2021-01-01 to 2021-12-31</code></pre>
<pre><code>## 
i fetching cached data from &lt;github.com&gt;

v fetching cached data from &lt;github.com&gt; ... done
## i No new data found - returning cached data
## Finished getting afltables data</code></pre>
<pre class="r"><code># afltables &lt;- fetch_player_stats_afltables(season = 2000:2010) #loads in data from 2000 to 2010</code></pre>
<p>Now that the data is loaded into our workspace, you can see in the ‘Environment’ tab that we have 9527 thousand rows (observations) and 59 columns (variables). We can confirm this with the <code>dim</code> (short for dimensions) function. Loading in the data from 1897 will have over 600k rows.</p>
<pre class="r"><code>dim(afltables) #rows by columns</code></pre>
<pre><code>## [1] 9527   59</code></pre>
<p>Lets use the head command, which shows the top 6 or so rows of our dataset.</p>
<pre class="r"><code>head(afltables)</code></pre>
<pre><code>## # A tibble: 6 x 59
##   Season Round Date       Local.start.time Venue  Attendance Home.team  HQ1G
##    &lt;dbl&gt; &lt;chr&gt; &lt;date&gt;                &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;int&gt;
## 1   2021 1     2021-03-18             1925 M.C.G.      49218 Richmond      3
## 2   2021 1     2021-03-18             1925 M.C.G.      49218 Richmond      3
## 3   2021 1     2021-03-18             1925 M.C.G.      49218 Richmond      3
## 4   2021 1     2021-03-18             1925 M.C.G.      49218 Richmond      3
## 5   2021 1     2021-03-18             1925 M.C.G.      49218 Richmond      3
## 6   2021 1     2021-03-18             1925 M.C.G.      49218 Richmond      3
## # ... with 51 more variables: HQ1B &lt;int&gt;, HQ2G &lt;int&gt;, HQ2B &lt;int&gt;, HQ3G &lt;int&gt;,
## #   HQ3B &lt;int&gt;, HQ4G &lt;int&gt;, HQ4B &lt;int&gt;, Home.score &lt;int&gt;, Away.team &lt;chr&gt;,
## #   AQ1G &lt;int&gt;, AQ1B &lt;int&gt;, AQ2G &lt;int&gt;, AQ2B &lt;int&gt;, AQ3G &lt;int&gt;, AQ3B &lt;int&gt;,
## #   AQ4G &lt;int&gt;, AQ4B &lt;int&gt;, Away.score &lt;int&gt;, First.name &lt;chr&gt;, Surname &lt;chr&gt;,
## #   ID &lt;dbl&gt;, Jumper.No. &lt;chr&gt;, Playing.for &lt;chr&gt;, Kicks &lt;dbl&gt;, Marks &lt;dbl&gt;,
## #   Handballs &lt;dbl&gt;, Goals &lt;dbl&gt;, Behinds &lt;dbl&gt;, Hit.Outs &lt;dbl&gt;, Tackles &lt;dbl&gt;,
## #   Rebounds &lt;dbl&gt;, Inside.50s &lt;dbl&gt;, Clearances &lt;dbl&gt;, Clangers &lt;dbl&gt;, ...</code></pre>
<p>And use the command <code>names</code> to check the column names, to help get a sense of what this data holds.</p>
<pre class="r"><code>names(afltables)</code></pre>
<pre><code>##  [1] &quot;Season&quot;                  &quot;Round&quot;                  
##  [3] &quot;Date&quot;                    &quot;Local.start.time&quot;       
##  [5] &quot;Venue&quot;                   &quot;Attendance&quot;             
##  [7] &quot;Home.team&quot;               &quot;HQ1G&quot;                   
##  [9] &quot;HQ1B&quot;                    &quot;HQ2G&quot;                   
## [11] &quot;HQ2B&quot;                    &quot;HQ3G&quot;                   
## [13] &quot;HQ3B&quot;                    &quot;HQ4G&quot;                   
## [15] &quot;HQ4B&quot;                    &quot;Home.score&quot;             
## [17] &quot;Away.team&quot;               &quot;AQ1G&quot;                   
## [19] &quot;AQ1B&quot;                    &quot;AQ2G&quot;                   
## [21] &quot;AQ2B&quot;                    &quot;AQ3G&quot;                   
## [23] &quot;AQ3B&quot;                    &quot;AQ4G&quot;                   
## [25] &quot;AQ4B&quot;                    &quot;Away.score&quot;             
## [27] &quot;First.name&quot;              &quot;Surname&quot;                
## [29] &quot;ID&quot;                      &quot;Jumper.No.&quot;             
## [31] &quot;Playing.for&quot;             &quot;Kicks&quot;                  
## [33] &quot;Marks&quot;                   &quot;Handballs&quot;              
## [35] &quot;Goals&quot;                   &quot;Behinds&quot;                
## [37] &quot;Hit.Outs&quot;                &quot;Tackles&quot;                
## [39] &quot;Rebounds&quot;                &quot;Inside.50s&quot;             
## [41] &quot;Clearances&quot;              &quot;Clangers&quot;               
## [43] &quot;Frees.For&quot;               &quot;Frees.Against&quot;          
## [45] &quot;Brownlow.Votes&quot;          &quot;Contested.Possessions&quot;  
## [47] &quot;Uncontested.Possessions&quot; &quot;Contested.Marks&quot;        
## [49] &quot;Marks.Inside.50&quot;         &quot;One.Percenters&quot;         
## [51] &quot;Bounces&quot;                 &quot;Goal.Assists&quot;           
## [53] &quot;Time.on.Ground..&quot;        &quot;Substitute&quot;             
## [55] &quot;Umpire.1&quot;                &quot;Umpire.2&quot;               
## [57] &quot;Umpire.3&quot;                &quot;Umpire.4&quot;               
## [59] &quot;group_id&quot;</code></pre>
<p>This next step I like to include cleans up some of the naming used, makes it more consistent format that is less likely to break a function later down the line.</p>
<pre class="r"><code>#rename all the columns to a snakecase format
names(afltables) &lt;- to_snake_case(names(afltables))
names(afltables) # now the column headers are in lowercase and have dots replaced with underscores</code></pre>
<pre><code>##  [1] &quot;season&quot;                  &quot;round&quot;                  
##  [3] &quot;date&quot;                    &quot;local_start_time&quot;       
##  [5] &quot;venue&quot;                   &quot;attendance&quot;             
##  [7] &quot;home_team&quot;               &quot;hq_1_g&quot;                 
##  [9] &quot;hq_1_b&quot;                  &quot;hq_2_g&quot;                 
## [11] &quot;hq_2_b&quot;                  &quot;hq_3_g&quot;                 
## [13] &quot;hq_3_b&quot;                  &quot;hq_4_g&quot;                 
## [15] &quot;hq_4_b&quot;                  &quot;home_score&quot;             
## [17] &quot;away_team&quot;               &quot;aq_1_g&quot;                 
## [19] &quot;aq_1_b&quot;                  &quot;aq_2_g&quot;                 
## [21] &quot;aq_2_b&quot;                  &quot;aq_3_g&quot;                 
## [23] &quot;aq_3_b&quot;                  &quot;aq_4_g&quot;                 
## [25] &quot;aq_4_b&quot;                  &quot;away_score&quot;             
## [27] &quot;first_name&quot;              &quot;surname&quot;                
## [29] &quot;id&quot;                      &quot;jumper_no&quot;              
## [31] &quot;playing_for&quot;             &quot;kicks&quot;                  
## [33] &quot;marks&quot;                   &quot;handballs&quot;              
## [35] &quot;goals&quot;                   &quot;behinds&quot;                
## [37] &quot;hit_outs&quot;                &quot;tackles&quot;                
## [39] &quot;rebounds&quot;                &quot;inside_50_s&quot;            
## [41] &quot;clearances&quot;              &quot;clangers&quot;               
## [43] &quot;frees_for&quot;               &quot;frees_against&quot;          
## [45] &quot;brownlow_votes&quot;          &quot;contested_possessions&quot;  
## [47] &quot;uncontested_possessions&quot; &quot;contested_marks&quot;        
## [49] &quot;marks_inside_50&quot;         &quot;one_percenters&quot;         
## [51] &quot;bounces&quot;                 &quot;goal_assists&quot;           
## [53] &quot;time_on_ground&quot;          &quot;substitute&quot;             
## [55] &quot;umpire_1&quot;                &quot;umpire_2&quot;               
## [57] &quot;umpire_3&quot;                &quot;umpire_4&quot;               
## [59] &quot;group_id&quot;</code></pre>
</div>
<div id="afl-stats" class="section level1">
<h1>AFL Stats</h1>
<p>Lets work towards two stats:</p>
<blockquote>
<p>Who has the highest amount of disposals equal to their tackle count?</p>
</blockquote>
<p>and:</p>
<blockquote>
<p>Which team has the highest accuracy?</p>
</blockquote>
<div id="selecting-columns" class="section level2">
<h2>Selecting columns</h2>
<p>Now that the data is loaded and in a format we can easily manipulate, lets take a look at some basic functions. <code>dplyr</code> has built in functions to make this process as painless as possible. Firstly, lets look at <code>select</code>, and function that keeps the columns we want to investigate. Also we are going to be making use of <code>%&gt;%</code>, known as a pipe, to channel our data through various functions. A shortcut for the command is <code>Ctrl</code> + <code>Shift</code> + <code>m</code>.</p>
<pre class="r"><code>afltables %&gt;% 
  select(season, round, id, first_name, surname, kicks, handballs, tackles)</code></pre>
<pre><code>## # A tibble: 9,527 x 8
##    season round    id first_name surname  kicks handballs tackles
##     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1   2021 1     12790 Jake       Aarts        7         5       2
##  2   2021 1     11828 David      Astbury      4         5       1
##  3   2021 1     12661 Liam       Baker        4        11       0
##  4   2021 1     12686 Noah       Balta       10         1       1
##  5   2021 1     12535 Shai       Bolton      13        12       1
##  6   2021 1     12456 Nathan     Broad        4         5       0
##  7   2021 1     12010 Josh       Caddy       12         5       2
##  8   2021 1     12431 Jason      Castagna     8         5       0
##  9   2021 1     11557 Shane      Edwards     11        16       3
## 10   2021 1     12576 Jack       Graham      22        11       3
## # ... with 9,517 more rows</code></pre>
</div>
<div id="combining-mutating-columns" class="section level2">
<h2>Combining (mutating) columns</h2>
<p>Nice, now we’ve got the data want to investigate, we can use a technique using a function called <code>mutate</code>. Whats interesting is this data source doesn’t have a disposals count column, but we can easily recreate it by adding handballs to kicks with one line of code.</p>
<pre class="r"><code>afltables %&gt;% 
  select(season, round, id, first_name, surname, kicks, handballs, tackles) %&gt;% 
  mutate(disposals = kicks + handballs) #name of our new column goes on the left hand side</code></pre>
<pre><code>## # A tibble: 9,527 x 9
##    season round    id first_name surname  kicks handballs tackles disposals
##     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1   2021 1     12790 Jake       Aarts        7         5       2        12
##  2   2021 1     11828 David      Astbury      4         5       1         9
##  3   2021 1     12661 Liam       Baker        4        11       0        15
##  4   2021 1     12686 Noah       Balta       10         1       1        11
##  5   2021 1     12535 Shai       Bolton      13        12       1        25
##  6   2021 1     12456 Nathan     Broad        4         5       0         9
##  7   2021 1     12010 Josh       Caddy       12         5       2        17
##  8   2021 1     12431 Jason      Castagna     8         5       0        13
##  9   2021 1     11557 Shane      Edwards     11        16       3        27
## 10   2021 1     12576 Jack       Graham      22        11       3        33
## # ... with 9,517 more rows</code></pre>
</div>
<div id="filtering-our-data" class="section level2">
<h2>Filtering our data</h2>
<p>Lets find all the times the disposal count was equal to the tackles. We can achieve this by using the <code>filter</code> function.</p>
<pre class="r"><code>afltables %&gt;% 
  select(season, round, id, first_name, surname, kicks, handballs, tackles) %&gt;% 
  mutate(disposals = kicks + handballs) %&gt;% 
  filter(disposals == tackles)</code></pre>
<pre><code>## # A tibble: 263 x 9
##    season round    id first_name surname   kicks handballs tackles disposals
##     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1   2021 1     12545 Callum     Brown         0         0       0         0
##  2   2021 1     12748 Rhylee     West          0         0       0         0
##  3   2021 1     12756 Kade       Chandler      0         0       0         0
##  4   2021 1     12265 Tom        Cutler        0         0       0         0
##  5   2021 1     12857 Connor     Downie        0         0       0         0
##  6   2021 1     12443 Rhys       Mathieson     0         0       0         0
##  7   2021 1     12509 Will       Hayward       0         0       0         0
##  8   2021 1     12865 Charlie    Lazzaro       1         0       1         1
##  9   2021 1     12821 Xavier     OHalloran     0         0       0         0
## 10   2021 1     12312 Mason      Wood          0         0       0         0
## # ... with 253 more rows</code></pre>
</div>
<div id="arranging-by-a-column" class="section level2">
<h2>Arranging by a column</h2>
<p>Ok, so we have all the occurrences when tackles was equal to disposals, what was the largest? We can use the <code>arrange</code> function on a column to sort by ascending or descending order. The default arrangement for a columns is ascending (smallest at the top to biggest), so we’ll wrap the column name in <code>desc()</code> to get the descending order.</p>
<pre class="r"><code>afltables %&gt;% 
  select(season, round, id, first_name, surname, kicks, handballs, tackles) %&gt;% 
  mutate(disposals = kicks + handballs) %&gt;% 
  filter(disposals == tackles) %&gt;% 
  arrange(desc(disposals))</code></pre>
<pre><code>## # A tibble: 263 x 9
##    season round    id first_name surname kicks handballs tackles disposals
##     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1   2021 16    12076 Dayne      Zorko       9         3      12        12
##  2   2021 17    12771 Kysaiah    Pickett     6         3       9         9
##  3   2021 21    12904 Kieren     Briggs      6         3       9         9
##  4   2021 9     12905 Ronin      OConnor     1         7       8         8
##  5   2021 16    11994 Scott      Lycett      5         3       8         8
##  6   2021 PF    12695 Willem     Drew        5         3       8         8
##  7   2021 8     12849 Sam        Berry       3         4       7         7
##  8   2021 9     12637 Jamaine    Jones       3         4       7         7
##  9   2021 13    12485 Mabior     Chol        4         3       7         7
## 10   2021 17    12596 Lachie     Fogarty     3         4       7         7
## # ... with 253 more rows</code></pre>
<p>And there we have it, your first AFL stat. You should see Dayne Zorko up the top with 12 disposals and tackles in round 16.</p>
</div>
<div id="group-by-and-summarise" class="section level2">
<h2>Group by and Summarise</h2>
<p>Grouping is a powerful tool we use to group certain values in columns. An example of this would be season, where each year is essentially its own category, and we can run commands that (for example) take the average amount of goals per team. Lets put this into practice with a simple example based off data we already have answering the following question:</p>
<blockquote>
<p>Which season has the highest accuracy?</p>
</blockquote>
<p>Lets pull in the data we need to create this stat. We need to sum the total goals and behinds per team.</p>
<pre class="r"><code>afltables %&gt;% 
  select(playing_for, goals, behinds) %&gt;% 
  group_by(playing_for) %&gt;% 
  summarise(
    sum_g = sum(goals),
    sum_b = sum(behinds),
    .groups = &#39;drop&#39;
  )</code></pre>
<pre><code>## # A tibble: 18 x 3
##    playing_for            sum_g sum_b
##    &lt;chr&gt;                  &lt;dbl&gt; &lt;dbl&gt;
##  1 Adelaide                 230   197
##  2 Brisbane Lions           333   222
##  3 Carlton                  250   201
##  4 Collingwood              225   166
##  5 Essendon                 291   200
##  6 Fremantle                219   220
##  7 Geelong                  295   213
##  8 Gold Coast               201   180
##  9 Greater Western Sydney   279   190
## 10 Hawthorn                 239   145
## 11 Melbourne                323   242
## 12 North Melbourne          213   157
## 13 Port Adelaide            294   213
## 14 Richmond                 253   183
## 15 St Kilda                 237   184
## 16 Sydney                   303   195
## 17 West Coast               257   168
## 18 Western Bulldogs         339   238</code></pre>
<p>Now that we have the total counts per team, we can use <code>mutate</code> to calculate accuracy, which is <span class="math inline">\(\dfrac{Goals}{Shots}\)</span>. We are also going to arrange the result to see which team has the highest accuracy in 2021.</p>
<pre class="r"><code>afltables %&gt;% 
  select(playing_for, goals, behinds) %&gt;% 
  group_by(playing_for) %&gt;% 
  summarise(
    sum_g = sum(goals),
    sum_b = sum(behinds),
    .groups = &#39;drop&#39;  #we also need to drop the grouping after running the command
  ) %&gt;% 
  mutate(
    accuracy = sum_g/(sum_g+sum_b)*100 #multiply by 100 to get a %
  ) %&gt;% 
  arrange(desc(accuracy))</code></pre>
<pre><code>## # A tibble: 18 x 4
##    playing_for            sum_g sum_b accuracy
##    &lt;chr&gt;                  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 Hawthorn                 239   145     62.2
##  2 Sydney                   303   195     60.8
##  3 West Coast               257   168     60.5
##  4 Brisbane Lions           333   222     60  
##  5 Greater Western Sydney   279   190     59.5
##  6 Essendon                 291   200     59.3
##  7 Western Bulldogs         339   238     58.8
##  8 Geelong                  295   213     58.1
##  9 Richmond                 253   183     58.0
## 10 Port Adelaide            294   213     58.0
## 11 North Melbourne          213   157     57.6
## 12 Collingwood              225   166     57.5
## 13 Melbourne                323   242     57.2
## 14 St Kilda                 237   184     56.3
## 15 Carlton                  250   201     55.4
## 16 Adelaide                 230   197     53.9
## 17 Gold Coast               201   180     52.8
## 18 Fremantle                219   220     49.9</code></pre>
<p>Nice, we can see that the year 2000 has the highest accuracy. Another question we might ask is which team in each round had the highest accuracy? We can group by a second variable, <code>round</code>.</p>
<pre class="r"><code>afltables %&gt;% 
  select(playing_for, round, goals, behinds) %&gt;% 
  group_by(playing_for, round) %&gt;% 
  summarise(
    sum_g = sum(goals),
    sum_b = sum(behinds),
    .groups = &#39;drop&#39;
  ) %&gt;% 
  mutate(
    accuracy = sum_g/(sum_g+sum_b)*100
  ) %&gt;% 
  arrange(desc(accuracy))</code></pre>
<pre><code>## # A tibble: 414 x 5
##    playing_for            round sum_g sum_b accuracy
##    &lt;chr&gt;                  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 Hawthorn               21       15     2     88.2
##  2 West Coast             4        13     2     86.7
##  3 Greater Western Sydney 3        11     2     84.6
##  4 Richmond               17       11     2     84.6
##  5 Adelaide               6        16     3     84.2
##  6 Hawthorn               13       14     3     82.4
##  7 Western Bulldogs       18       14     3     82.4
##  8 Carlton                20       18     4     81.8
##  9 Adelaide               19       16     4     80  
## 10 Hawthorn               5         8     2     80  
## # ... with 404 more rows</code></pre>
<p>Hawthorn in Round 21 topping the charts with a whopping 88% accuracy. <code>group_by</code> and <code>summarise</code> work really well together, and you can switch out <code>sum</code> with <code>mean</code> for the average, or <code>max</code> and <code>min</code> for the maximum and minimum in each group.</p>
<p>You could also switch out <code>playing_for</code> with <code>id</code>,<code>first_name</code> and <code>surname</code> to get individual player’s accuracy. Another variation is to import the data from 2000 to 2022. The possibilities are endless.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>Thanks for making it this far, hopefully its given you a taste of the potential insights (useful or useless) that R and AFL have to offer. This is hopefully the first in a series of tutorials about AFL analytics in R. You can contact us on twitter or Facebook, let us know what you found interesting, insightful, difficult, any other types of stats you’d like to see recreated in upcoming posts. <a href="https://twitter.com/crow_data_sci" target="blank">@crow_data_sci</a></p>
</div>
